Lab Tasks
=========

You can use the AUCA server for this work through SSH at 'iuca.space'. The login
has the format `<last name>_<first letter of the first name>`.

## Lab #1, Find the Password

Proove that security by obscurity does not always work by finding passwords in the executables `1`, `2`, and `3` located
at `iuca-infosec` of your home directory on the `iuca.space` server. Try analyzing the binary with the `strings` command and
the `gdb` debugger. Try using the rainbow tables to find the value of the hash in the last executable.

## Lab #2, Break the Cipher

Given the following [text](https://drive.google.com/file/d/19Q60HCDDswcSA_BvWlVV-Q641Vs2i1KA/view?usp=sharing), try to break it by using at least two different approaches discussed during the class. Select one approach and write a decryption function in Python for any text that uses the same symmetric encryption scheme.

Try using a Jupyter notebook. You can get one online for free at <https://notebooks.azure.com>.

## Lab #3, Encryption System

Create two Java applications, one that can encrypt any given text with a symmetric AES cipher, and another that can decrypt the
given text. Allow the key to be bundled and transmited together with the encrypted data through untrusted channels.

1. You can use the following guide to understand what classes you have to use and how <https://goo.gl/RhLm1b>.

The command-line interface should be the following

    java Encryptor <file> <private key file>
    # produces a file named <text file>.enc

    java Decryptor <file>.enc <public key file>
    # produces a file named <file>.dec

2. Swap keys in the code.

### How to Generate a Key Pair

```bash
openssl genrsa -out key.pem 2048
openssl pkcs8 -topk8 -inform PEM -outform DER -in key.pem -out key -nocrypt
openssl rsa -in key.pem -pubout -outform DER -out key.pub
```

## Lab #4, Authentication

1. Deploy a simple web-application locally or remotely from `iuca-infosec/blog` dir on `iuca.space` server.

You can use the following `tcpdump` command to catch all the HTTP requests and write them to the `log.txt` file.

```bash
tcpdump -A -s 0 'tcp port PORT and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)' > log.txt
```

You may find the following packages usefull

* [Node.js](https://nodejs.org/en/download)
* [MySQL](https://dev.mysql.com/downloads/file/?id=478883)
* [MySQL Portable Database Scripts](https://github.com/toksaitov/portable-mysql.git)

2. Perform a security audit of the software.

3. Make improvements to the software to secure it.

* [Let's Encrypt Certificates](https://letsencrypt.org)
* [Enabling HTTPS in Express](https://timonweb.com/posts/running-expressjs-server-over-https)
* [bcrypt Hash Library for Node.js](https://www.npmjs.com/package/bcrypt)

## Lab #5, Unix Access Control

1. For a collaborative project, create and share a directory with another team member
   on `iuca.space` in your home directory. Allow him to read and create new files.
   
2. Consider that your team got a new member. Use ACL to also allow him to work with the
   project directory.

* [ACL, Ubuntu](https://help.ubuntu.com/community/FilePermissionsACLs)

## Lab #6, Spyware Analyses

1. Research what should an application do to track global key presses on Windows. Try to find the
specific API calls and build a simple key tracking application in C#, Java, or Python around them.

2. In a virtualized environment analyze the behaviour of popular antivirus software packages to your program.

## Lab #7 (Final Project), RAT Analyses

Select sources of one of the Remote-Access-Trojans in the malware source code, sample database
<https://github.com/malwares>. In brief words, write a report in a markdown format about it.

In your report try to answer the following questions.

* What was the language used to create the RAT?
* What Windows specific APIs were used to allow the RAT to function?
* What Windows specific vulnarabilities were used to allow the RAT to function?
* Were any other software APIs or vulnerabilities exploited by the tool?
* How can one protect the system against this particular RAT (describe multiple approaches)?

Outline the functionality of the RAT and the basic steps the tool was doing
to abuse the system.

Remember to use the virtualized environment to avoid harm to your machine.

## Lab #8, Virus Analyses

Do the same tasks from lab #7, but for any self-replicating virus. You can use the following database for this task
<https://github.com/ytisf/theZoo>.

## Lab #9, Buffer Overflow

Write, compile and execute the sample programs from the course book (starting from page 319, chapter 10) to perform buffer overflow. Try to disable (and then enable) the protection mechanisms available on your system to be able to achive similar results to those provided in the book. Study the assembly generated by the compiler. Be able to explain what happens on the assembly level when the bufer overflow happens.

## Lab #10, Metasploit, Pentesting

Prepare the [Metasploit](https://www.metasploit.com) environment based on [Kali Linux](https://www.kali.org/downloads/). Prepare a vulnerable system based on the [Metasploitable](https://metasploit.help.rapid7.com/docs/metasploitable-2) Linux image. Study on
how to use these tools to perform pentesting by following [this](https://www.offensive-security.com/metasploit-unleashed) guide.

## Lab 11 (Final Project), Operating System Hardening

Study virtualization, containerisation, technologies. Utilize Docker and Vagrant to prepare a hardened images of operating system to
deploy for a given web application. Utilize best practices from all the previous labs to ensure the system follows the CIA principles.
Refer to the video lecture recording for specific instructions.

### Documentation for Helpfull Unix Tools

    man strings
    man gdb

### Links

* [Beej's Guide to C Programming](http://beej.us/guide/bgc)

### Books

* _C Programming: A Modern Approach, 2nd Edition by K. N. King_
